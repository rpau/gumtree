plugins {
    id 'application'
}

dependencies {
    implementation project(':gen.jdt')
    implementation project(':gen.python')
    implementation project(':gen.treesitter')
}

jar.enabled = false
run.enabled = false

task execNotebook(type: Exec) {
    // jupyter nbconvert --execute --to html benchmark.ipynb
    commandLine "jupyter", "nbconvert", "--execute", "--to", "html", "${project.projectDir}/src/main/python/analysis.ipynb", "--output-dir='${project.buildDir}/reports'"
}

task runOnDefects4J(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = 'com.github.gumtree.benchmark.RunOnDataset'
    args "${project.projectDir}/datasets/defects4j", "${project.buildDir}/reports/defects4j.csv"
}

task runOnGhJava(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = 'com.github.gumtree.benchmark.RunOnDataset'
    args "${project.projectDir}/datasets/gh-java", "${project.buildDir}/reports/gh-java.csv"
}

task runOnGhPython(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = 'com.github.gumtree.benchmark.RunOnDataset'
    args "${project.projectDir}/datasets/gh-python", "${project.buildDir}/reports/gh-python.csv"
}

task runOnBugsInPy(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = 'com.github.gumtree.benchmark.RunOnDataset'
    args "${project.projectDir}/datasets/bugsinpy", "${project.buildDir}/reports/bugsinpy.csv"
}
